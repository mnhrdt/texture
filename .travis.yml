language: c
sudo: required
fast_finish: true

matrix:
  include:
    - os: linux
      dist: trusty
    - os: osx

install:
  - |
    if [ "$TRAVIS_OS_NAME" == "osx" ] ; then
      brew update
      brew install geographiclib
      brew upgrade libgeotiff
      brew upgrade cgal
      brew unlink gdal
      U=http://www.kyngchaos.com/files/software/frameworks/GDAL_Complete-2.1.dmg
      wget $U
      Y=`hdiutil mount GDAL_Complete-2.1.dmg|tail -1|awk '{$1=$2="";print $0}'`
      X=`echo $Y | xargs -0 echo`
      sudo installer -pkg "${X}/"GDAL\ Complete.pkg -target /
      export PATH="/Library/Frameworks/GDAL.framework/Programs:$PATH"
    fi

script:
  - make
  - make test
